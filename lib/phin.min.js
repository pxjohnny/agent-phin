"use strict";const{URL:URL}=require("url"),centra=require("centra"),phin=async e=>{if("string"!=typeof e&&!e.hasOwnProperty("url"))throw new Error("Missing url option from options for request method.");const r=centra("object"==typeof e?e.url:e,e.method||"GET");e.headers&&r.header(e.headers),e.stream&&r.stream(),e.timeout&&r.timeout(e.timeout),e.data&&r.body(e.data),e.form&&r.body(e.form,"form"),e.compression&&r.compress(),e.agent&&r.option("agent",e.agent);const t=await r.send();return t.headers.hasOwnProperty("location")&&e.followRedirects?(e.url=new URL(t.headers.location,e.url).toString(),await phin(e)):e.stream?(t.stream=t,t):(t.coreRes.body=t.body,e.parse&&"json"===e.parse?(t.coreRes.body=await t.json(),t.coreRes):t.coreRes)};phin.promisified=phin,phin.unpromisified=((e,r)=>{phin(e).then(e=>{r&&r(null,e)}).catch(e=>{r&&r(e,null)})}),phin.defaults=(e=>async r=>await phin(Object.assign(e,"string"==typeof r?{url:r}:r))),module.exports=phin;
